<link rel="stylesheet" href="/form.css">
<div class="container my-5 d-flex justify-content-center">
  <div class=" shadow-lg p-4 mx-auto" style="max-width: 700px; width: 100%;">
      <div class="card-body small">
          <div class="text-center mb-4">
              <h3>Submit Your Information</h3>
          </div>

          <form action="/form" method="POST" enctype="multipart/form-data " class="mt-5">
              <div class="row">
                  <!-- Name -->
                  <div class="col-md-6 mb-3">
                      <label for="name" class="form-label">Name:</label>
                      <input type="text" class="form-control" name="name" id="name" placeholder="Enter your name" required value="<%=user.name %>" readonly>
                  </div>
                  
                  <!-- Rating -->
                  <div class="col-md-6 mb-3">
                    <label class="form-label">Rate Us:</label>
                    <div class="rating">
                        <% for(let i = 5; i >= 1; i--) { %>
                            <input type="radio" name="rating" id="star<%= i %>" value="<%= i %>" <%= testimonial && testimonial.rating == i ? 'checked' : '' %> required>
                            <label for="star<%= i %>">â˜…</label>
                        <% } %>
                    </div>
                </div>
              </div>

              <div class="row">
                  <!-- City -->
                  <div class="col-md-6 mb-3">
                      <label for="city" class="form-label">City:</label>
                      <input type="text" class="form-control text-capitalize" name="city" id="city" placeholder="Enter your city"  required value="<%= testimonial ? testimonial.city : '' %>">
                  </div>
                  
                  <!-- Country -->
                  <div class="col-md-6 mb-3">
                      <label for="country" class="form-label">Country:</label>
                      <input type="text" class="form-control text-capitalize" name="country" id="country" placeholder="Enter your country"  value="<%= testimonial ? testimonial.country : '' %>" required>
                  </div>
              </div>

              <!-- Reviews -->
              <div class="mb-3">
                <label for="reviews" class="form-label">Reviews:</label>
                <textarea class="form-control" name="reviews" id="reviews" rows="4" placeholder="Write your reviews here..." required><%= testimonial ? testimonial.reviews : '' %></textarea>
                <small id="charCount" class="text-muted">Remaining characters: 200</small>
            </div>

              <!-- Submit Button -->
              <div class="d-grid">
                  <button type="submit" class="btn btn-primary">Submit</button>
              </div>
          </form>
      </div>
  </div>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const reviewInput = document.getElementById("reviews");
        const charCount = document.getElementById("charCount");
        const maxLength = 120;
        const minLength =0;

        // Function to update remaining characters
       function updateCharCount() {
    let remaining = maxLength - reviewInput.value.length;
    
    // Prevent negative values
    remaining = remaining < 0 ? 0 : remaining;

    charCount.textContent = `Remaining characters: ${remaining}`;

    // Change color if out of range
    charCount.style.color = (remaining === 0 || remaining < 10) ? "red" : "black";
}

        // Run function once on page load to account for pre-filled value
        updateCharCount();

        // Update counter on user input
        reviewInput.addEventListener("input", updateCharCount);

        const form = document.querySelector("form");
        form.addEventListener("submit", function (event) {
            const reviewLength = reviewInput.value.trim().length;
            
            if (reviewLength >= 120) {
                event.preventDefault();
                showToast("You have entered more than 120 characters.");
            } 
        });

        function showToast(message) {
            let toast = document.createElement("div");
            toast.innerText = message;
            toast.style.position = "fixed";
            toast.style.bottom = "20px";
            toast.style.left = "50%";
            toast.style.transform = "translateX(-50%)";
            toast.style.backgroundColor = "#dc3545";
            toast.style.color = "#fff";
            toast.style.padding = "10px 20px";
            toast.style.borderRadius = "5px";
            toast.style.zIndex = "1000";
            toast.style.fontSize = "14px";
            document.body.appendChild(toast);

            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    });
</script>
   
    